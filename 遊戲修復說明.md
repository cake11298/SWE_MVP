# 遊戲修復說明

## 完成的修復項目

### 1. ✅ QTE 系統改進
- **持續時間**: 從 10 秒延長到 **20 秒**
- **技能檢查次數**: 從 3 次增加到 **4 次**
- **每次檢查時間**: **3 秒**
- **檢查間隔**: **1 秒**
- **中斷處理**: 放開右鍵會中斷 QTE，液體不會被標記為已搖晃

**使用方法:**
- 按住右鍵開始搖晃
- QTE 總共持續 20 秒
- 會出現 4 次技能檢查（每次 3 秒）
- 當指針在綠色區域時按 R
- 如果放開右鍵，QTE 會失敗

### 2. ✅ Shaker 倒酒功能
- Shaker 現在可以像酒瓶一樣倒酒
- 會追蹤容量並在倒酒時減少
- 倒酒速度: 20ml/秒

**使用方法:**
- 拿起 shaker
- 按住左鍵倒酒
- 對準杯子倒入混合飲料
- Shaker 的容量會隨著倒酒減少

### 3. ✅ 暫停系統修復
- 按 ESC 暫停時，整個遊戲會完全停止
- 暫停時解鎖滑鼠游標
- 恢復時鎖定滑鼠游標

### 4. ✅ 基酒等級顯示
在 LiquidInfoUI 面板中顯示 5 種基酒及其等級：
- Vodka（伏特加）
- Gin（琴酒）
- Rum（蘭姆酒）
- Whiskey（威士忌）
- Wine（葡萄酒）

顯示格式：
```
=== Base Liquors ===
Vodka: ★★★☆☆ Lv.3
Gin: ★★☆☆☆ Lv.2
...
```

### 5. ✅ 裝飾品系統
- 創建了 DecorationManager 系統
- SM_Speakers 和 SM_Speakers2 在購買前會被隱藏
- 購買後（花費 $3000）會顯示
- 購買狀態會在遊戲之間保存

### 6. ✅ 遊戲結束系統
- 時間到達 24:00 時遊戲結束
- 按 P 鍵可以強制結束遊戲
- GameEndPanel 會顯示統計數據和升級選項

## 設置步驟

### 自動設置（推薦）
1. 打開 Unity
2. 點擊菜單: **Bar Simulator > Setup > Complete Game Setup (Run This!)**
3. 檢查控制台的設置結果

### 手動設置（如果需要）
- **設置裝飾管理器**: Bar Simulator > Setup > Setup Decoration Manager
- **設置基酒顯示**: Bar Simulator > Setup > Setup Liquor Levels UI

## 測試清單

### QTE 系統測試
- [ ] 在有液體的 shaker 上按住右鍵
- [ ] QTE 應該持續 20 秒
- [ ] 應該出現 4 次技能檢查
- [ ] 在 QTE 期間放開右鍵
- [ ] QTE 應該失敗，液體不應被標記為已搖晃

### Shaker 倒酒測試
- [ ] 向 shaker 添加液體
- [ ] 搖晃 shaker（完成 QTE）
- [ ] 按住左鍵倒酒
- [ ] 對準杯子
- [ ] 液體應該倒入杯子
- [ ] Shaker 容量應該減少

### 暫停系統測試
- [ ] 遊戲中按 ESC
- [ ] 遊戲應該完全停止
- [ ] 滑鼠游標應該可見
- [ ] 再次按 ESC 恢復
- [ ] 遊戲應該正常繼續

### 基酒等級顯示測試
- [ ] 檢查 LiquidInfoUI 面板
- [ ] 應該顯示 5 種基酒及星級評分

### 裝飾品系統測試
- [ ] 開始新遊戲
- [ ] SM_Speakers 和 SM_Speakers2 應該被隱藏
- [ ] 完成遊戲並賺取 $3000+
- [ ] 在 GameEndUI 中購買音箱
- [ ] 開始下一局遊戲
- [ ] 音箱應該現在可見

### 遊戲結束系統測試
- [ ] 玩到時間到達 24:00
- [ ] GameEndPanel 應該出現
- [ ] 或者在遊戲中按 P
- [ ] GameEndPanel 應該出現

## 修改的文件

1. `Assets/Scripts/Systems/ShakerQTESystem.cs` - QTE 改進
2. `Assets/Scripts/Objects/Shaker.cs` - 倒酒功能
3. `Assets/Scripts/UI/SimplePauseMenu.cs` - 暫停修復
4. `Assets/Scripts/UI/LiquidInfoUI.cs` - 基酒等級顯示
5. `Assets/Scripts/UI/GameEndUI.cs` - 調試日誌
6. `Assets/Scripts/Core/GameManager.cs` - 遊戲結束觸發

## 新增的文件

1. `Assets/Scripts/Systems/DecorationManager.cs` - 裝飾品可見性系統
2. `Assets/Scripts/Editor/SetupDecorationManager.cs` - 設置腳本
3. `Assets/Scripts/Editor/SetupLiquorLevelsUI.cs` - 設置腳本
4. `Assets/Scripts/Editor/CompleteGameSetup.cs` - 完整設置腳本

## 注意事項

1. **Shaker 倒酒**: 確保 shaker 有碰撞器才能正常工作
2. **裝飾管理器**: 場景啟動時自動運行
3. **QTE 中斷**: 只在放開右鍵時有效
4. **基酒等級**: 需要 PersistentGameData 初始化（自動進行）

## 如果遇到問題

1. 檢查 Unity 控制台的錯誤訊息
2. 重新運行完整設置腳本
3. 驗證 Inspector 中的所有引用都已分配
4. 檢查 GameEndUI 組件中是否分配了 GameEndPanel

---

**最後更新:** 2024年12月16日
